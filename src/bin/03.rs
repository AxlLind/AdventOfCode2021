static INPUT: &str = "010000010010\n011001011100\n110011011101\n110100100001\n000110011110\n110101000101\n100110111001\n110000000000\n100101100111\n001001011000\n010010011010\n001110111000\n001011111010\n110010111011\n001001010101\n111111011111\n101001001110\n011001000101\n001001111100\n000101110000\n101000101101\n101000011101\n011011001111\n010100011001\n100010001000\n100010111010\n000110101100\n100101010111\n110111101111\n011101111001\n111001110110\n101101000000\n010010111101\n111101111101\n010000001110\n000111111001\n010111100101\n011101100000\n001011011111\n111010000110\n111010001001\n000000010111\n001110011110\n100011100010\n111110010111\n100111111111\n100000011011\n000110111101\n010100010111\n110000011111\n011011011001\n101110011100\n010110001111\n101010111001\n100010011111\n011110110101\n001001101010\n000001001000\n101101011000\n101100001111\n000110000011\n011011100001\n010011100001\n101111011100\n110110100000\n010100010000\n110111111000\n110000110111\n011000000101\n001100011111\n111000011010\n000110101010\n011000101001\n110010100110\n100011111010\n011111000111\n010001100101\n101000011110\n011110010010\n111001100000\n000011011010\n000011111110\n101001001001\n100110010010\n110101010111\n010011111000\n010111001111\n010101001011\n111001010100\n011001011001\n110011110111\n110001001011\n101101001011\n000110010111\n110110111010\n001001100110\n111010011011\n001101000101\n100110001011\n010000101000\n101111001011\n110011011110\n011110111001\n101100000010\n010101101101\n010100001010\n000111010101\n001100000111\n010001010010\n001110000110\n000001010000\n100010000101\n010010101101\n011000110110\n111111100000\n111111010011\n010100010001\n101011000010\n111010101000\n011010001010\n111001000001\n111010010000\n101010101100\n101011110110\n110010100010\n011001001100\n100100111010\n101011011101\n110000001000\n010011011101\n000011011000\n101100101111\n110001111111\n110010010010\n001011011010\n110101111110\n110000111010\n011100011110\n110110001000\n000101000001\n100000010100\n110000110000\n110000101100\n101101000001\n110011101001\n101110010101\n110101110101\n000110100000\n100111101111\n111101011001\n110001111101\n100010100001\n101011111100\n000011010111\n110100110101\n111100010100\n011001110011\n010000110000\n110110011100\n001000110101\n010001111111\n001000000110\n101001001100\n011000001011\n101101010110\n101100011101\n001111001010\n110011000010\n010110111001\n000011000000\n011110100000\n111001001010\n110010100101\n110001101001\n001100110100\n110100011111\n100010001001\n100101001010\n110001011000\n111110011111\n001001000010\n101011001010\n110111111001\n101000000111\n000110000000\n110011110000\n111001011110\n110000010010\n010000101101\n010010100101\n011110010000\n010011100011\n111011100110\n001001000011\n110000010101\n010010010100\n110100100111\n111111010110\n111001110010\n110100010010\n011111111010\n110000011011\n001011000101\n101010000010\n000111100011\n010000110110\n111111011001\n100001001001\n111010011100\n001111110000\n010111111001\n101101000111\n100110011111\n000000100111\n111001111010\n100001110000\n010110101101\n111111111110\n101101011010\n101101000011\n010011001001\n111111000010\n011110000010\n101110101101\n110010110010\n101111100101\n101011100000\n000001110111\n010011011000\n010011000101\n101101010000\n111011110111\n100111111010\n000001110010\n010011110100\n011100001010\n101101001111\n011101100001\n001111001011\n000000010101\n000100110101\n100111001011\n000111011001\n100010011110\n111100100101\n011010111001\n011011111101\n010100111011\n010100110100\n101111111001\n110001100110\n110001110001\n010110100011\n111111110100\n011101000010\n011111101111\n001101001011\n001010100110\n111001010000\n111111100110\n001101001100\n010110011010\n011101111000\n101000010111\n100110010101\n011000111010\n011100010011\n110011000111\n001101010101\n101110001101\n000001011100\n001011100111\n111111010101\n000110010110\n100110000011\n011000111011\n111001011111\n100001010000\n001000100011\n011011111111\n111001001110\n000001010111\n001001001111\n001001100010\n111100101110\n101101100100\n000111101010\n011101101110\n101111001000\n010101110111\n100001011111\n011110011111\n010111010000\n101100110100\n001110011010\n000110001100\n110100101011\n101010001101\n010100001101\n111101011111\n011110111111\n110100001001\n101010000001\n110100011001\n100011011011\n101001111111\n111101100011\n100101001100\n000010101011\n101111010010\n100001110111\n010000011100\n011101110100\n100000001111\n100010110111\n101011110101\n000001000111\n010011110110\n000001000010\n101010010010\n100111110101\n000010001111\n001110000100\n110100001101\n011001001011\n000100110000\n000000011101\n011011100000\n011000001110\n000011101111\n110111010101\n011000001010\n010001111101\n011111011001\n001010111011\n010000011111\n001100000011\n110110001110\n100000000010\n010101011010\n101001100110\n000110011001\n110101001110\n100111000111\n111101101100\n100101111011\n011111100000\n000000101011\n001111011110\n101100100100\n010010110001\n000110110001\n011100111001\n001011000100\n111100001101\n100010001101\n010101010111\n001011101110\n110111101110\n000010000101\n101111001111\n101110000000\n010000011110\n101111000101\n000101001011\n011101000100\n001001111110\n001001111111\n100111000110\n000101110010\n011001001111\n100000111110\n101000001100\n001110010001\n010101011111\n010110001101\n000001000101\n010100111101\n100000101010\n111111111101\n011111001101\n111000001111\n100100001011\n101111010011\n111111110111\n100101111111\n100111100111\n011000110111\n011010000001\n010010110000\n111000110100\n111100010110\n100010100111\n011010111111\n110101100011\n001111100001\n101001011110\n100011110011\n100111110111\n100000100100\n111010110011\n001011100101\n101101010001\n111010111110\n000100010110\n111101001111\n101001001111\n000001010101\n111011101001\n010101111111\n111110101000\n101101111011\n010100001100\n101011110001\n010011101111\n011001001001\n001000001001\n100100011111\n010111100001\n111101011110\n110011110101\n100101000010\n100011110001\n000111111010\n010001011111\n011110011011\n100100000000\n011010011001\n010001100000\n011111001100\n101011000110\n110100101110\n101000111011\n011011001000\n100111000010\n101110011101\n000110000001\n001101001101\n100110011000\n011110111010\n110101010000\n100100111000\n011111000011\n111101010101\n100011101100\n000101110100\n010110101010\n101001111110\n011100010110\n001100010100\n010101110001\n100101110111\n110110100101\n100011000011\n100101000101\n001111110011\n101100010111\n001011110101\n001010110001\n110000010011\n100111100100\n100110110010\n101101110110\n000100101011\n101111100100\n011010110110\n101110010111\n000010101110\n001000000111\n100000110110\n001000000000\n111011101000\n111011011001\n000011111011\n000010101101\n011100111011\n000111010000\n000010110001\n011100110101\n001111110111\n000110100011\n010010001010\n010100000001\n111101101101\n010010010011\n110101100100\n011001010100\n100101110100\n110111011100\n110001110011\n011011001011\n110011011011\n101110101111\n111011000001\n110010001111\n000001000000\n101101111100\n000111000001\n000001011001\n110100110000\n110101011100\n010110011000\n010110010000\n010110000011\n010010010000\n100001100010\n011110110001\n111100101010\n101111111010\n101010110001\n000110011011\n010110000001\n001110111001\n000111101011\n010110110110\n000000000101\n000100010000\n110000010000\n001011011101\n011111000101\n001110101010\n101110110111\n110101110111\n101111000110\n110110000011\n110001110010\n011111101000\n010111100110\n011100111111\n111101100100\n110111110100\n100010010000\n110101000111\n111000000111\n111111011010\n100001111010\n010011011100\n011011100101\n110100101000\n001101110010\n000010110100\n110001010101\n100000011100\n101101100111\n011100111110\n111110001110\n010011101101\n001001001110\n011001100001\n001010010100\n010011010011\n001111100010\n001110001100\n011011010010\n010100000100\n011010010011\n101110011010\n001111101000\n001110011011\n000001111110\n110110101001\n101000000110\n000010000111\n100111111001\n110111001101\n110101101011\n110101100110\n101010110011\n000110100001\n110011100100\n001011101101\n011001001010\n100101100110\n010001100001\n110110001101\n100111011001\n100100111100\n000001111010\n110000111011\n110101100000\n001111111111\n010010100110\n001011111100\n111011000110\n101011010110\n001100011110\n010010010001\n011001110111\n110110110001\n010110100000\n110010011001\n001111000001\n100100010100\n000001111100\n000011101001\n101001110010\n011100000111\n001000011110\n010001111100\n010010110100\n110000111000\n100100001100\n010111100010\n010010001000\n100110001110\n111101110100\n011111011000\n001000110000\n000010100000\n010111000000\n001111101110\n000111110101\n001000001011\n111100001001\n011010011111\n011101101111\n000101011011\n000100000101\n001000010101\n000011000001\n011011010100\n011101100101\n000010110111\n001101000011\n000111001000\n001010000111\n111010101110\n100001111111\n101101110000\n010111011101\n111010111000\n011111000110\n011100001011\n101011100110\n011011100100\n010010000001\n001100101011\n000110111010\n010110011101\n010100101101\n100001100101\n011011010111\n111010111001\n111000001010\n100101011110\n001000011001\n101001101001\n011111000001\n010010111110\n101110110110\n111110010011\n100111011100\n001100100011\n100010101100\n111100001110\n010101101111\n010001000111\n110101111010\n011100100101\n110001010011\n000011100001\n001010111001\n011100011010\n010101010101\n001011000000\n101011110111\n011001110010\n010000001011\n000011100010\n010010000011\n011001111010\n000101011100\n111010000101\n001011111011\n011011101101\n100100110111\n111000101010\n100001110101\n101110010100\n000001100111\n101001101111\n100000001100\n110000101000\n110111011010\n010001001010\n000100000001\n110110101011\n011111101011\n101001100010\n000111100001\n010010001011\n101001010110\n011011100011\n000111011101\n100000100101\n000010100011\n111010001011\n111110111111\n101000111000\n110100100011\n010001110010\n001000010000\n111101011011\n110100011011\n010101100110\n010001101111\n001111011111\n101111110110\n011011101111\n000010101111\n000000110011\n011011000111\n010001000110\n010111101111\n110101011111\n001001000111\n011011001110\n100111110110\n111100100001\n111010100010\n010010000010\n000111110111\n111101000100\n000011110011\n111000101111\n110010011111\n000001101001\n001110101001\n011111101110\n110111010010\n011100110010\n100011000111\n000000010011\n011011111100\n011110010101\n110111101011\n011001111101\n010101010110\n011110011001\n111100011100\n011001010001\n000110110101\n000111010010\n101011101011\n101010100000\n011101011001\n001110111111\n011011010110\n110111100001\n100011111011\n001010011101\n111001101101\n011100001000\n011010011100\n100111010011\n000010010110\n010110010001\n111010010110\n111111110101\n100011000101\n011010001001\n111010001010\n000100000110\n011010001000\n100110101001\n010111111011\n010111100011\n011101010100\n101000011001\n101001110111\n111001010101\n100110111111\n111010110110\n100000011000\n110010100001\n001110011111\n010001011010\n011100100011\n010111011110\n100110110100\n111000001000\n110110101000\n000000001111\n010111101010\n000100000100\n111000110010\n011111110011\n001100100001\n010100000111\n111010100111\n010001101110\n101111110010\n011111000100\n101100111110\n010111101100\n011110111000\n110001000100\n011101000111\n011011101000\n000100100110\n100110100110\n000000001011\n010101001111\n110001000001\n100011010011\n101000100011\n011011010011\n100010001110\n100111101001\n101111111111\n111010011001\n011000010100\n110101011101\n100110101011\n010000011001\n010011011001\n010101000101\n010100011111\n100111001000\n111110100011\n000110010010\n000000010010\n101110001100\n111010000011\n100001001000\n000011010101\n000100011000\n001111111100\n011110101000\n101111011111\n100000111011\n101001100011\n001001100100\n000100010100\n010111101101\n101001111010\n011000101011\n111011010010\n011001101001\n011101010110\n011011110011\n010010101010\n001111010100\n100000010110\n001101000111\n000010101010\n110010001001\n011001111100\n000100001000\n010111001011\n101111100111\n100111100011\n100001010101\n100111011011\n100101000110\n011010100110\n100011101110\n111010110010\n010000100000\n100100110110\n011001101101\n011111100100\n101100101101\n101010110100\n101001000111\n110100010100\n011101001000\n101110101100\n111100010001\n001101011101\n111111110110\n101110001011\n001100101111\n110000001010\n110011001000\n011100000110\n011001101000\n001100001011\n111000111011\n111100000111\n010000000001\n000101011111\n001000101110\n101101101011\n111111110010\n111000001110\n110101111100\n101100010011\n010011110111\n100100010111\n111001101001\n101000001011\n110001110111\n100011111100\n000101011110\n011000101000\n001010011110\n100111111110\n100000111010\n001111010101\n011111010100\n001101101100\n010011111001\n001010101100\n001110111101\n000101010000\n100101101011\n010100101010\n000000001001\n010011000100\n010001000100\n110101100101\n110011011111\n100001010111\n111111011000\n010111111100\n111000101000\n101011101100\n111111011100\n001110110100\n000010100010\n111101110001\n101011000000\n101101000101\n110000000100\n110111111101\n101110100110\n111011000000\n001011010000\n100100101001\n111110101010\n111011110011\n111000000011\n000101101001\n110100011100\n111101000000\n100000100001\n010110001011\n001100111011\n110000100010\n111001010111\n100100001111\n110111111110\n010111000101\n110000010111\n100011010000\n101010110111\n011100101110\n001110001000\n110011100001\n100101001110\n110110110110\n101110001001\n011011001001\n110000101101\n001000001101\n001000000010\n110110010000\n011110001100\n100001011101\n000001010100\n010100111110\n101110111111\n101010101110\n001100010000\n100000001011\n010011101100\n101011011001\n111100000000\n011011110001\n001110001110\n010100100101\n111011101100\n011110101101\n010110100010\n101010001111\n110110000101\n101000110110\n101101001110\n111111101111\n001001110010\n001001011010\n111100100110\n000101010011\n100100001000\n110111010000\n010010001111\n000000100101\n001101110100\n101010110010\n011110010111\n100011001110\n111011010011\n110011111001\n110100100100\n110101001000\n110001111011\n010110001100\n011110111100\n010100000101";

fn count_bit(nums: &[u32], bit: usize) -> (usize,usize) {
  let mut c = [0,0];
  for &x in nums {
    c[(x as usize >> bit) & 1] += 1
  }
  (c[0], c[1])
}

fn part1(nums: &[u32]) -> u32 {
  let (mut x, mut y) = (0,0);
  for i in 0..12 {
    let (zero, one) = count_bit(nums, i);
    let tmp = if one > zero {&mut x} else {&mut y};
    *tmp += 1 << i;
  }
  x * y
}

fn part2(nums: &[u32], a: u32, b: u32) -> u32 {
  let mut nums = nums.to_vec();
  for i in (0..12).rev() {
    let (zero, one) = count_bit(&nums, i);
    let keep = if one >= zero {a} else {b};
    nums.retain(|x| (x>>i) & 1 == keep);
    if nums.len() == 1 { break }
  }
  nums[0]
}

aoc2021::main! {
  let input = INPUT.lines()
    .map(|l| u32::from_str_radix(l, 2).unwrap())
    .collect::<Vec<_>>();
  let p1 = part1(&input);
  let p2 = part2(&input, 1, 0) * part2(&input, 0, 1);
  (p1,p2)
}
